(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3945],{4470:(e,n,r)=>{"use strict";r.r(n),r.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>m,frontMatter:()=>d,metadata:()=>u,toc:()=>h});var t=r(74848),o=r(28453),s=r(78847),a=r(64428),i=r(53509),l=r.n(i);const d={hide_table_of_contents:!0},c="Cloudflare Workers AI",u={id:"integrations/text_embedding/cloudflare_ai",title:"Cloudflare Workers AI",description:"If you're deploying your project in a Cloudflare worker, you can use Cloudflare's built-in Workers AI embeddings with LangChain.js.",source:"@site/docs/integrations/text_embedding/cloudflare_ai.mdx",sourceDirName:"integrations/text_embedding",slug:"/integrations/text_embedding/cloudflare_ai",permalink:"/docs/integrations/text_embedding/cloudflare_ai",draft:!1,unlisted:!1,editUrl:"https://langchainjs-kr.site/docs/integrations/text_embedding/cloudflare_ai.mdx",tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"integrations",previous:{title:"Bedrock",permalink:"/docs/integrations/text_embedding/bedrock"},next:{title:"Cohere",permalink:"/docs/integrations/text_embedding/cohere"}},p={},h=[{value:"Setup",id:"setup",level:2},...s.toc,{value:"Usage",id:"usage",level:2}];function g(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"cloudflare-workers-ai",children:"Cloudflare Workers AI"}),"\n",(0,t.jsxs)(n.p,{children:["If you're deploying your project in a Cloudflare worker, you can use Cloudflare's ",(0,t.jsx)(n.a,{href:"https://developers.cloudflare.com/workers-ai/",children:"built-in Workers AI embeddings"})," with LangChain.js."]}),"\n",(0,t.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,t.jsxs)(n.p,{children:["First, ",(0,t.jsx)(n.a,{href:"https://developers.cloudflare.com/workers-ai/get-started/workers-wrangler/",children:"follow the official docs"})," to set up your worker."]}),"\n",(0,t.jsx)(n.p,{children:"You'll also need to install the LangChain Cloudflare integration package:"}),"\n","\n",(0,t.jsx)(s.default,{}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:"npm2yarn",children:"npm install @langchain/cloudflare\n"})}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsxs)(n.p,{children:["Below is an example worker that uses Workers AI embeddings with a ",(0,t.jsx)(n.a,{href:"/docs/integrations/vectorstores/cloudflare_vectorize",children:"Cloudflare Vectorize"})," vectorstore."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["If running locally, be sure to run wrangler as ",(0,t.jsx)(n.code,{children:"npx wrangler dev --remote"}),"!"]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",children:'name = "langchain-test"\nmain = "worker.js"\ncompatibility_date = "2024-01-10"\n\n[[vectorize]]\nbinding = "VECTORIZE_INDEX"\nindex_name = "langchain-test"\n\n[ai]\nbinding = "AI"\n'})}),"\n","\n",(0,t.jsx)(a.A,{language:"typescript",children:l()})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}},53509:e=>{e.exports={content:'// @ts-nocheck\n\nimport type {\n  VectorizeIndex,\n  Fetcher,\n  Request,\n} from "@cloudflare/workers-types";\n\nimport {\n  CloudflareVectorizeStore,\n  CloudflareWorkersAIEmbeddings,\n} from "@langchain/cloudflare";\n\nexport interface Env {\n  VECTORIZE_INDEX: VectorizeIndex;\n  AI: Fetcher;\n}\n\nexport default {\n  async fetch(request: Request, env: Env) {\n    const { pathname } = new URL(request.url);\n    const embeddings = new CloudflareWorkersAIEmbeddings({\n      binding: env.AI,\n      model: "@cf/baai/bge-small-en-v1.5",\n    });\n    const store = new CloudflareVectorizeStore(embeddings, {\n      index: env.VECTORIZE_INDEX,\n    });\n    if (pathname === "/") {\n      const results = await store.similaritySearch("hello", 5);\n      return Response.json(results);\n    } else if (pathname === "/load") {\n      // Upsertion by id is supported\n      await store.addDocuments(\n        [\n          {\n            pageContent: "hello",\n            metadata: {},\n          },\n          {\n            pageContent: "world",\n            metadata: {},\n          },\n          {\n            pageContent: "hi",\n            metadata: {},\n          },\n        ],\n        { ids: ["id1", "id2", "id3"] }\n      );\n\n      return Response.json({ success: true });\n    } else if (pathname === "/clear") {\n      await store.delete({ ids: ["id1", "id2", "id3"] });\n      return Response.json({ success: true });\n    }\n\n    return Response.json({ error: "Not Found" }, { status: 404 });\n  },\n};\n',imports:[{local:"CloudflareVectorizeStore",imported:"CloudflareVectorizeStore",source:"@langchain/cloudflare"},{local:"CloudflareWorkersAIEmbeddings",imported:"CloudflareWorkersAIEmbeddings",source:"@langchain/cloudflare"}]}}}]);