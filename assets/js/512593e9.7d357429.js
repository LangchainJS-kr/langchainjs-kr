"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6704],{21674:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var a=t(74848),s=t(28453);const o={sidebar_class_name:"hidden",title:"How to return citations"},i=void 0,r={id:"how_to/qa_citations",title:"How to return citations",description:"This guide assumes familiarity with the following:",source:"@site/docs/how_to/qa_citations.mdx",sourceDirName:"how_to",slug:"/how_to/qa_citations",permalink:"/docs/how_to/qa_citations",draft:!1,unlisted:!1,editUrl:"https://langchainjs-kr.site/docs/how_to/qa_citations.mdx",tags:[],version:"current",frontMatter:{sidebar_class_name:"hidden",title:"How to return citations"},sidebar:"tutorialSidebar",previous:{title:"How to add chat history to a question-answering chain",permalink:"/docs/how_to/qa_chat_history_how_to"},next:{title:"How to return sources",permalink:"/docs/how_to/qa_sources"}},h={},c=[{value:"Setup",id:"setup",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"LangSmith",id:"langsmith",level:3},{value:"Initial setup",id:"initial-setup",level:3},{value:"Tool calling",id:"tool-calling",level:2},{value:"Cite documents",id:"cite-documents",level:3},{value:"Cite snippets",id:"cite-snippets",level:3},{value:"Direct prompting",id:"direct-prompting",level:2},{value:"Setup",id:"setup-1",level:3},{value:"Retrieval post-processing",id:"retrieval-post-processing",level:2},{value:"Next steps",id:"next-steps",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.admonition,{title:"Prerequisites",type:"info",children:[(0,a.jsx)(n.p,{children:"This guide assumes familiarity with the following:"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../../docs/tutorials/rag/",children:"Retrieval-augmented generation"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"../../docs/how_to/structured_output/",children:"Returning structured data from a\nmodel"})}),"\n"]})]}),"\n",(0,a.jsx)(n.p,{children:"How can we get a model to cite which parts of the source documents it\nreferenced in its response?"}),"\n",(0,a.jsxs)(n.p,{children:["To explore some techniques for extracting citations, let\u2019s first create\na simple RAG chain. To start we\u2019ll just retrieve from the web using the\n",(0,a.jsx)(n.a,{href:"https://js.langchain.com/docs/integrations/retrievers/tavily",children:(0,a.jsx)(n.code,{children:"TavilySearchAPIRetriever"})}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,a.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,a.jsxs)(n.p,{children:["We\u2019ll use an OpenAI chat model and embeddings and a Memory vector store\nin this walkthrough, but everything shown here works with any\n",(0,a.jsx)(n.a,{href:"../../docs/concepts/#chat-models",children:"ChatModel"})," or\n",(0,a.jsx)(n.a,{href:"../../docs/concepts#llms",children:"LLM"}),",\n",(0,a.jsx)(n.a,{href:"../../docs/concepts#embedding-models/",children:"Embeddings"}),", and\n",(0,a.jsx)(n.a,{href:"../../docs/concepts#vectorstores/",children:"VectorStore"})," or\n",(0,a.jsx)(n.a,{href:"../../docs/concepts#retrievers",children:"Retriever"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"We\u2019ll use the following packages:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install --save langchain @langchain/community @langchain/openai\n"})}),"\n",(0,a.jsx)(n.p,{children:"We need to set environment variables for Tavily Search & OpenAI:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"export OPENAI_API_KEY=YOUR_KEY\nexport TAVILY_API_KEY=YOUR_KEY\n"})}),"\n",(0,a.jsx)(n.h3,{id:"langsmith",children:"LangSmith"}),"\n",(0,a.jsxs)(n.p,{children:["Many of the applications you build with LangChain will contain multiple\nsteps with multiple invocations of LLM calls. As these applications get\nmore and more complex, it becomes crucial to be able to inspect what\nexactly is going on inside your chain or agent. The best way to do this\nis with ",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/",children:"LangSmith"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Note that LangSmith is not needed, but it is helpful. If you do want to\nuse LangSmith, after you sign up at the link above, make sure to set\nyour environment variables to start logging traces:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"export LANGCHAIN_TRACING_V2=true\nexport LANGCHAIN_API_KEY=YOUR_KEY\n"})}),"\n",(0,a.jsx)(n.h3,{id:"initial-setup",children:"Initial setup"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { TavilySearchAPIRetriever } from "@langchain/community/retrievers/tavily_search_api";\nimport { ChatPromptTemplate } from "@langchain/core/prompts";\nimport { ChatOpenAI } from "@langchain/openai";\n\nconst llm = new ChatOpenAI({\n  model: "gpt-3.5-turbo",\n  temperature: 0,\n});\n\nconst retriever = new TavilySearchAPIRetriever({\n  k: 6,\n});\n\nconst prompt = ChatPromptTemplate.fromMessages([\n  [\n    "system",\n    "You\'re a helpful AI assistant. Given a user question and some web article snippets, answer the user question. If none of the articles answer the question, just say you don\'t know.\\n\\nHere are the web articles:{context}",\n  ],\n  ["human", "{question}"],\n]);\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Now that we\u2019ve got a model, retriever and prompt, let\u2019s chain them all\ntogether. We\u2019ll need to add some logic for formatting our retrieved\n",(0,a.jsx)(n.code,{children:"Document"}),"s to a string that can be passed to our prompt. We\u2019ll make it\nso our chain returns both the answer and the retrieved Documents."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { Document } from "@langchain/core/documents";\nimport { StringOutputParser } from "@langchain/core/output_parsers";\nimport { RunnableMap, RunnablePassthrough } from "@langchain/core/runnables";\n\n/**\n * Format the documents into a readable string.\n */\nconst formatDocs = (input: Record<string, any>): string => {\n  const { docs } = input;\n  return (\n    "\\n\\n" +\n    docs\n      .map(\n        (doc: Document) =>\n          `Article title: ${doc.metadata.title}\\nArticle Snippet: ${doc.pageContent}`\n      )\n      .join("\\n\\n")\n  );\n};\n// subchain for generating an answer once we\'ve done retrieval\nconst answerChain = prompt.pipe(llm).pipe(new StringOutputParser());\nconst map = RunnableMap.from({\n  question: new RunnablePassthrough(),\n  docs: retriever,\n});\n// complete chain that calls the retriever -> formats docs to string -> runs answer subchain -> returns just the answer and retrieved docs.\nconst chain = map\n  .assign({ context: formatDocs })\n  .assign({ answer: answerChain })\n  .pick(["answer", "docs"]);\n\nawait chain.invoke("How fast are cheetahs?");\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'{\n  answer: "Cheetahs are the fastest land animals on Earth. They can reach speeds as high as 75 mph or 120 km/h."... 124 more characters,\n  docs: [\n    Document {\n      pageContent: "Contact Us \u2212 +\\n" +\n        "Address\\n" +\n        "Smithsonian\'s National Zoo & Conservation\xa0Biology\xa0Institute\xa0\xa03001 Connecticut"... 1343 more characters,\n      metadata: {\n        title: "Cheetah | Smithsonian\'s National Zoo and Conservation Biology Institute",\n        source: "https://nationalzoo.si.edu/animals/cheetah",\n        score: 0.96283,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "Now, their only hope lies in the hands of human conservationists, working tirelessly to save the che"... 880 more characters,\n      metadata: {\n        title: "How Fast Are Cheetahs, and Other Fascinating Facts About the World\'s ...",\n        source: "https://www.discovermagazine.com/planet-earth/how-fast-are-cheetahs-and-other-fascinating-facts-abou"... 21 more characters,\n        score: 0.96052,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely r"... 1048 more characters,\n      metadata: {\n        title: "Cheetah | Description, Speed, Habitat, Diet, Cubs, & Facts",\n        source: "https://www.britannica.com/animal/cheetah-mammal",\n        score: 0.93137,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The science of cheetah speed\\n" +\n        "The cheetah (Acinonyx jubatus) is the fastest land animal on Earth, cap"... 738 more characters,\n      metadata: {\n        title: "How Fast Can a Cheetah Run? - ThoughtCo",\n        source: "https://www.thoughtco.com/how-fast-can-a-cheetah-run-4587031",\n        score: 0.91385,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "One of two videos from National Geographic\'s award-winning multimedia coverage of cheetahs in the ma"... 60 more characters,\n      metadata: {\n        title: "The Science of a Cheetah\'s Speed | National Geographic",\n        source: "https://www.youtube.com/watch?v=icFMTB0Pi0g",\n        score: 0.90358,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "If a lion comes along, the cheetah will abandon its catch -- it can\'t fight off a lion, and chances "... 911 more characters,\n      metadata: {\n        title: "What makes a cheetah run so fast? | HowStuffWorks",\n        source: "https://animals.howstuffworks.com/mammals/cheetah-speed.htm",\n        score: 0.87824,\n        images: null\n      }\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["See a LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/bb0ed37e-b2be-4ae9-8b0d-ce2aff0b4b5e/r",children:"here"}),"\nthat shows off the internals."]}),"\n",(0,a.jsx)(n.h2,{id:"tool-calling",children:"Tool calling"}),"\n",(0,a.jsx)(n.h3,{id:"cite-documents",children:"Cite documents"}),"\n",(0,a.jsxs)(n.p,{children:["Let\u2019s try using ",(0,a.jsx)(n.a,{href:"../../docs/how_to/tool_calling",children:"tool calling"})," to make\nthe model specify which of the provided documents it\u2019s actually\nreferencing when answering. LangChain has some utils for converting\nobjects or ",(0,a.jsx)(n.a,{href:"https://zod.dev",children:"Zod"})," objects to the JSONSchema format\nexpected by providers like OpenAI. We\u2019ll use the\n",(0,a.jsx)(n.a,{href:"../../docs/how_to/structured_output/",children:(0,a.jsx)(n.code,{children:".withStructuredOutput()"})})," method\nto get the model to output data matching our desired schema:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { z } from "zod";\n\nconst llmWithTool1 = llm.withStructuredOutput(\n  z\n    .object({\n      answer: z\n        .string()\n        .describe(\n          "The answer to the user question, which is based only on the given sources."\n        ),\n      citations: z\n        .array(z.number())\n        .describe(\n          "The integer IDs of the SPECIFIC sources which justify the answer."\n        ),\n    })\n    .describe("A cited source from the given text"),\n  {\n    name: "cited_answers",\n  }\n);\n\nconst exampleQ = `What is Brian\'s height?\n\nSource: 1\nInformation: Suzy is 6\'2"\n\nSource: 2\nInformation: Jeremiah is blonde\n\nSource: 3\nInformation: Brian is 3 inches shorter than Suzy`;\n\nawait llmWithTool1.invoke(exampleQ);\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"{\n  answer: `Brian is 6'2\" - 3 inches = 5'11\" tall.`,\n  citations: [ 1, 3 ]\n}\n"})}),"\n",(0,a.jsxs)(n.p,{children:["See a LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/28736c75-122e-4deb-9916-55c73eea3167/r",children:"here"}),"\nthat shows off the internals"]}),"\n",(0,a.jsx)(n.p,{children:"Now we\u2019re ready to put together our chain"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { Document } from "@langchain/core/documents";\n\nconst formatDocsWithId = (docs: Array<Document>): string => {\n  return (\n    "\\n\\n" +\n    docs\n      .map(\n        (doc: Document, idx: number) =>\n          `Source ID: ${idx}\\nArticle title: ${doc.metadata.title}\\nArticle Snippet: ${doc.pageContent}`\n      )\n      .join("\\n\\n")\n  );\n};\n// subchain for generating an answer once we\'ve done retrieval\nconst answerChain1 = prompt.pipe(llmWithTool1);\nconst map1 = RunnableMap.from({\n  question: new RunnablePassthrough(),\n  docs: retriever,\n});\n// complete chain that calls the retriever -> formats docs to string -> runs answer subchain -> returns just the answer and retrieved docs.\nconst chain1 = map1\n  .assign({\n    context: (input: { docs: Array<Document> }) => formatDocsWithId(input.docs),\n  })\n  .assign({ cited_answer: answerChain1 })\n  .pick(["cited_answer", "docs"]);\n\nawait chain1.invoke("How fast are cheetahs?");\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'{\n  cited_answer: {\n    answer: "Cheetahs can reach speeds as high as 75 mph or 120 km/h.",\n    citations: [ 1, 2, 5 ]\n  },\n  docs: [\n    Document {\n      pageContent: "One of two videos from National Geographic\'s award-winning multimedia coverage of cheetahs in the ma"... 60 more characters,\n      metadata: {\n        title: "The Science of a Cheetah\'s Speed | National Geographic",\n        source: "https://www.youtube.com/watch?v=icFMTB0Pi0g",\n        score: 0.97858,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely r"... 1048 more characters,\n      metadata: {\n        title: "Cheetah | Description, Speed, Habitat, Diet, Cubs, & Facts",\n        source: "https://www.britannica.com/animal/cheetah-mammal",\n        score: 0.97213,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The science of cheetah speed\\n" +\n        "The cheetah (Acinonyx jubatus) is the fastest land animal on Earth, cap"... 738 more characters,\n      metadata: {\n        title: "How Fast Can a Cheetah Run? - ThoughtCo",\n        source: "https://www.thoughtco.com/how-fast-can-a-cheetah-run-4587031",\n        score: 0.95759,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "Contact Us \u2212 +\\n" +\n        "Address\\n" +\n        "Smithsonian\'s National Zoo & Conservation\xa0Biology\xa0Institute\xa0\xa03001 Connecticut"... 1343 more characters,\n      metadata: {\n        title: "Cheetah | Smithsonian\'s National Zoo and Conservation Biology Institute",\n        source: "https://nationalzoo.si.edu/animals/cheetah",\n        score: 0.92422,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "Now, their only hope lies in the hands of human conservationists, working tirelessly to save the che"... 880 more characters,\n      metadata: {\n        title: "How Fast Are Cheetahs, and Other Fascinating Facts About the World\'s ...",\n        source: "https://www.discovermagazine.com/planet-earth/how-fast-are-cheetahs-and-other-fascinating-facts-abou"... 21 more characters,\n        score: 0.91867,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The speeds attained by the cheetah may be only slightly greater than those achieved by the pronghorn"... 2527 more characters,\n      metadata: {\n        title: "Cheetah - Wikipedia",\n        source: "https://en.wikipedia.org/wiki/Cheetah",\n        score: 0.81617,\n        images: null\n      }\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["See a LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/86814255-b9b0-4c4f-9463-e795c9961451/r",children:"here"}),"\nthat shows off the internals."]}),"\n",(0,a.jsx)(n.h3,{id:"cite-snippets",children:"Cite snippets"}),"\n",(0,a.jsx)(n.p,{children:"What if we want to cite actual text spans? We can try to get our model\nto return these, too."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Note"}),": Note that if we break up our documents so that we have many\ndocuments with only a sentence or two instead of a few long documents,\nciting documents becomes roughly equivalent to citing snippets, and may\nbe easier for the model because the model just needs to return an\nidentifier for each snippet instead of the actual text. We recommend\ntrying both approaches and evaluating."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { Document } from "@langchain/core/documents";\n\nconst citationSchema = z.object({\n  sourceId: z\n    .number()\n    .describe(\n      "The integer ID of a SPECIFIC source which justifies the answer."\n    ),\n  quote: z\n    .string()\n    .describe(\n      "The VERBATIM quote from the specified source that justifies the answer."\n    ),\n});\n\nconst llmWithTool2 = llm.withStructuredOutput(\n  z.object({\n    answer: z\n      .string()\n      .describe(\n        "The answer to the user question, which is based only on the given sources."\n      ),\n    citations: z\n      .array(citationSchema)\n      .describe("Citations from the given sources that justify the answer."),\n  }),\n  {\n    name: "quoted_answer",\n  }\n);\n\nconst answerChain2 = prompt.pipe(llmWithTool2);\nconst map2 = RunnableMap.from({\n  question: new RunnablePassthrough(),\n  docs: retriever,\n});\n// complete chain that calls the retriever -> formats docs to string -> runs answer subchain -> returns just the answer and retrieved docs.\nconst chain2 = map2\n  .assign({\n    context: (input: { docs: Array<Document> }) => formatDocsWithId(input.docs),\n  })\n  .assign({ quoted_answer: answerChain2 })\n  .pick(["quoted_answer", "docs"]);\n\nawait chain2.invoke("How fast are cheetahs?");\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'{\n  quoted_answer: {\n    answer: "Cheetahs can reach speeds of up to 120kph or 75mph, making them the world\u2019s fastest land animals.",\n    citations: [\n      {\n        sourceId: 5,\n        quote: "Cheetahs can reach speeds of up to 120kph or 75mph, making them the world\u2019s fastest land animals."\n      },\n      {\n        sourceId: 1,\n        quote: "The cheetah (Acinonyx jubatus) is the fastest land animal on Earth, capable of reaching speeds as hi"... 25 more characters\n      },\n      {\n        sourceId: 3,\n        quote: "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely r"... 72 more characters\n      }\n    ]\n  },\n  docs: [\n    Document {\n      pageContent: "Contact Us \u2212 +\\n" +\n        "Address\\n" +\n        "Smithsonian\'s National Zoo & Conservation\xa0Biology\xa0Institute\xa0\xa03001 Connecticut"... 1343 more characters,\n      metadata: {\n        title: "Cheetah | Smithsonian\'s National Zoo and Conservation Biology Institute",\n        source: "https://nationalzoo.si.edu/animals/cheetah",\n        score: 0.95973,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The science of cheetah speed\\n" +\n        "The cheetah (Acinonyx jubatus) is the fastest land animal on Earth, cap"... 738 more characters,\n      metadata: {\n        title: "How Fast Can a Cheetah Run? - ThoughtCo",\n        source: "https://www.thoughtco.com/how-fast-can-a-cheetah-run-4587031",\n        score: 0.92749,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "Now, their only hope lies in the hands of human conservationists, working tirelessly to save the che"... 880 more characters,\n      metadata: {\n        title: "How Fast Are Cheetahs, and Other Fascinating Facts About the World\'s ...",\n        source: "https://www.discovermagazine.com/planet-earth/how-fast-are-cheetahs-and-other-fascinating-facts-abou"... 21 more characters,\n        score: 0.92417,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely r"... 1048 more characters,\n      metadata: {\n        title: "Cheetah | Description, Speed, Habitat, Diet, Cubs, & Facts",\n        source: "https://www.britannica.com/animal/cheetah-mammal",\n        score: 0.92341,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "One of two videos from National Geographic\'s award-winning multimedia coverage of cheetahs in the ma"... 60 more characters,\n      metadata: {\n        title: "The Science of a Cheetah\'s Speed | National Geographic",\n        source: "https://www.youtube.com/watch?v=icFMTB0Pi0g",\n        score: 0.90025,\n        images: null\n      }\n    },\n    Document {\n      pageContent: "In fact, they are more closely related to kangaroos\u2026\\n" +\n        "Read more\\n" +\n        "Animals on the Galapagos Islands: A G"... 987 more characters,\n      metadata: {\n        title: "How fast can cheetahs run, and what enables their incredible speed?",\n        source: "https://wildlifefaq.com/cheetah-speed/",\n        score: 0.87121,\n        images: null\n      }\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["You can check out a LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/f0588adc-1914-45e8-a2ed-4fa028cea0e1/r",children:"here"}),"\nthat shows off the internals."]}),"\n",(0,a.jsx)(n.h2,{id:"direct-prompting",children:"Direct prompting"}),"\n",(0,a.jsx)(n.p,{children:"Not all models support tool-calling. We can achieve similar results with\ndirect prompting. Let\u2019s see what this looks like using an older\nAnthropic chat model that is particularly proficient in working with\nXML:"}),"\n",(0,a.jsx)(n.h3,{id:"setup-1",children:"Setup"}),"\n",(0,a.jsx)(n.p,{children:"Install the LangChain Anthropic integration package:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npm install @langchain/anthropic\n"})}),"\n",(0,a.jsx)(n.p,{children:"Add your Anthropic API key to your environment:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"export ANTHROPIC_API_KEY=YOUR_KEY\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { ChatAnthropic } from "@langchain/anthropic";\nimport { ChatPromptTemplate } from "@langchain/core/prompts";\nimport { XMLOutputParser } from "@langchain/core/output_parsers";\nimport { Document } from "@langchain/core/documents";\nimport {\n  RunnableLambda,\n  RunnablePassthrough,\n  RunnableMap,\n} from "@langchain/core/runnables";\n\nconst anthropic = new ChatAnthropic({\n  model: "claude-instant-1.2",\n  temperature: 0,\n});\nconst system = `You\'re a helpful AI assistant. Given a user question and some web article snippets,\nanswer the user question and provide citations. If none of the articles answer the question, just say you don\'t know.\n\nRemember, you must return both an answer and citations. A citation consists of a VERBATIM quote that\njustifies the answer and the ID of the quote article. Return a citation for every quote across all articles\nthat justify the answer. Use the following format for your final output:\n\n<cited_answer>\n    <answer></answer>\n    <citations>\n        <citation><source_id></source_id><quote></quote></citation>\n        <citation><source_id></source_id><quote></quote></citation>\n        ...\n    </citations>\n</cited_answer>\n\nHere are the web articles:{context}`;\n\nconst anthropicPrompt = ChatPromptTemplate.fromMessages([\n  ["system", system],\n  ["human", "{question}"],\n]);\n\nconst formatDocsToXML = (docs: Array<Document>): string => {\n  const formatted: Array<string> = [];\n  docs.forEach((doc, idx) => {\n    const docStr = `<source id="${idx}">\n  <title>${doc.metadata.title}</title>\n  <article_snippet>${doc.pageContent}</article_snippet>\n</source>`;\n    formatted.push(docStr);\n  });\n  return `\\n\\n<sources>${formatted.join("\\n")}</sources>`;\n};\n\nconst format3 = new RunnableLambda({\n  func: (input: { docs: Array<Document> }) => formatDocsToXML(input.docs),\n});\nconst answerChain = anthropicPrompt\n  .pipe(anthropic)\n  .pipe(new XMLOutputParser())\n  .pipe(\n    new RunnableLambda({\n      func: (input: { cited_answer: any }) => input.cited_answer,\n    })\n  );\nconst map3 = RunnableMap.from({\n  question: new RunnablePassthrough(),\n  docs: retriever,\n});\nconst chain3 = map3\n  .assign({ context: format3 })\n  .assign({ cited_answer: answerChain })\n  .pick(["cited_answer", "docs"]);\n\nconst res = await chain3.invoke("How fast are cheetahs?");\n\nconsole.log(JSON.stringify(res, null, 2));\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'{\n  "cited_answer": [\n    {\n      "answer": "Cheetahs can reach top speeds of around 75 mph, but can only maintain bursts of speed for short distances before tiring."\n    },\n    {\n      "citations": [\n        {\n          "citation": [\n            {\n              "source_id": "1"\n            },\n            {\n              "quote": "Scientists calculate a cheetah\'s top speed is 75 mph, but the fastest recorded speed is somewhat slower."\n            }\n          ]\n        },\n        {\n          "citation": [\n            {\n              "source_id": "3"\n            },\n            {\n              "quote": "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely reach velocities of 80\u2013100 km (50\u201362 miles) per hour while pursuing prey."\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  "docs": [\n    {\n      "pageContent": "One of two videos from National Geographic\'s award-winning multimedia coverage of cheetahs in the magazine\'s November 2012 iPad edition. See the other: http:...",\n      "metadata": {\n        "title": "The Science of a Cheetah\'s Speed | National Geographic",\n        "source": "https://www.youtube.com/watch?v=icFMTB0Pi0g",\n        "score": 0.96603,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "The science of cheetah speed\\nThe cheetah (Acinonyx jubatus) is the fastest land animal on Earth, capable of reaching speeds as high as 75 mph or 120 km/h. Cheetahs are predators that sneak up on their prey and sprint a short distance to chase and attack.\\n Key Takeaways: How Fast Can a Cheetah Run?\\nFastest Cheetah on Earth\\nScientists calculate a cheetah\'s top speed is 75 mph, but the fastest recorded speed is somewhat slower. The top 10 fastest animals are:\\nThe pronghorn, an American animal resembling an antelope, is the fastest land animal in the Western Hemisphere. While a cheetah\'s top speed ranges from 65 to 75 mph (104 to 120 km/h), its average speed is only 40 mph (64 km/hr), punctuated by short bursts at its top speed. Basically, if a predator threatens to take a cheetah\'s kill or attack its young, a cheetah has to run.\\n",\n      "metadata": {\n        "title": "How Fast Can a Cheetah Run? - ThoughtCo",\n        "source": "https://www.thoughtco.com/how-fast-can-a-cheetah-run-4587031",\n        "score": 0.96212,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "Now, their only hope lies in the hands of human conservationists, working tirelessly to save the cheetahs, the leopards and all the other wildlife of the scattered savannas and other habitats of Africa and Asia.\\n Their tough paw pads and grippy claws are made to grab at the ground, and their large nasal passages and lungs facilitate the flow of oxygen and allow their rapid intake of air as they reach their top speeds.\\n And though the two cats share a similar coloration, a cheetah\'s spots are circular while a leopard\'s spots are rose-shaped \\"rosettes,\\" with the centers of their spots showing off the tan color of their coats.\\n Also classified as \\"vulnerable\\" are two of the cheetah\'s foremost foes, the lion and the leopard, the latter of which is commonly confused for the cheetah thanks to its own flecked fur.\\n The cats are also consumers of the smallest of the bigger, bulkier antelopes, such as sables and kudus, and are known to gnaw on the occasional rabbit or bird.\\n",\n      "metadata": {\n        "title": "How Fast Are Cheetahs, and Other Fascinating Facts About the World\'s ...",\n        "source": "https://www.discovermagazine.com/planet-earth/how-fast-are-cheetahs-and-other-fascinating-facts-about-the-worlds-quickest",\n        "score": 0.95688,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely reach velocities of 80\u2013100 km (50\u201362 miles) per hour while pursuing prey.\\ncheetah,\\n(Acinonyx jubatus),\\none of the world\u2019s most-recognizable cats, known especially for its speed. Their fur is dark and includes a thick yellowish gray mane along the back, a trait that presumably offers better camouflage and increased protection from high temperatures during the day and low temperatures at night during the first few months of life. Cheetahs eat a variety of small animals, including game birds, rabbits, small antelopes (including the springbok, impala, and gazelle), young warthogs, and larger antelopes (such as the kudu, hartebeest, oryx, and roan).\\n A cheetah eats a variety of small animals, including game birds, rabbits, small antelopes (including the springbok, impala, and gazelle), young warthogs, and larger antelopes (such as the kudu, hartebeest, oryx, and roan). Their faces are distinguished by prominent black lines that curve from the inner corner of each eye to the outer corners of the mouth, like a well-worn trail of inky tears.",\n      "metadata": {\n        "title": "Cheetah | Description, Speed, Habitat, Diet, Cubs, & Facts",\n        "source": "https://www.britannica.com/animal/cheetah-mammal",\n        "score": 0.95589,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "Contact Us \u2212 +\\nAddress\\nSmithsonian\'s National Zoo & Conservation\xa0Biology\xa0Institute\xa0\xa03001 Connecticut Ave., NW\xa0\xa0Washington, DC 20008\\nAbout the Zoo\\n\u2212\\n+\\nCareers\\n\u2212\\n+\\nNews & Media\\n\u2212\\n+\\nFooter Donate\\n\u2212\\n+\\nShop\\n\u2212\\n+\\nFollow us on social media\\nSign Up for Emails\\nFooter - SI logo, privacy, terms Conservation Efforts\\nHistorically, cheetahs ranged widely throughout Africa and Asia, from the Cape of Good Hope to the Mediterranean, throughout the Arabian Peninsula and the Middle East, from Israel, India and Pakistan north to the northern shores of the Caspian and Aral Seas, and west through Uzbekistan, Turkmenistan, Afghanistan, and Pakistan into central India. Header Links\\nToday\'s hours: 8 a.m. to 4 p.m. (last entry 3 p.m.)\\nMega menu\\nAnimals Global Nav Links\\nElephant Cam\\nSee the Smithsonian\'s National Zoo\'s Asian elephants \u2014 Spike, Bozie, Kamala, Swarna and Maharani \u2014 both inside the Elephant Community Center and outside in their yards.\\n Conservation Global Nav Links\\nAbout the Smithsonian Conservation Biology Institute\\nCheetah\\nAcinonyx jubatus\\nBuilt for speed, the cheetah can accelerate from zero to 45 in just 2.5 seconds and reach top speeds of 60 to 70 mph, making it the fastest land mammal! Fun Facts\\nConservation Status\\nCheetah News\\nTaxonomic Information\\nAnimal News\\nNZCBI staff in Front Royal, Virginia, are mourning the loss of Walnut, a white-naped crane who became an internet sensation for choosing one of her keepers as her mate.\\n",\n      "metadata": {\n        "title": "Cheetah | Smithsonian\'s National Zoo and Conservation Biology Institute",\n        "source": "https://nationalzoo.si.edu/animals/cheetah",\n        "score": 0.94744,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "The speeds attained by the cheetah may be only slightly greater than those achieved by the pronghorn at 88.5\xa0km/h (55.0\xa0mph)[96] and the springbok at 88\xa0km/h (55\xa0mph),[97] but the cheetah additionally has an exceptional acceleration.[98]\\nOne stride of a galloping cheetah measures 4 to 7\xa0m (13 to 23\xa0ft); the stride length and the number of jumps increases with speed.[60] During more than half the duration of the sprint, the cheetah has all four limbs in the air, increasing the stride length.[99] Running cheetahs can retain up to 90% of the heat generated during the chase. In December 2016 the results of an extensive survey detailing the distribution and demography of cheetahs throughout the range were published; the researchers recommended listing the cheetah as Endangered on the IUCN Red List.[25]\\nThe cheetah was reintroduced in Malawi in 2017.[160]\\nIn Asia\\nIn 2001, the Iranian government collaborated with the CCF, the IUCN, Panthera Corporation, UNDP and the Wildlife Conservation Society on the Conservation of Asiatic Cheetah Project (CACP) to protect the natural habitat of the Asiatic cheetah and its prey.[161][162] Individuals on the periphery of the prey herd are common targets; vigilant prey which would react quickly on seeing the cheetah are not preferred.[47][60][122]\\nCheetahs are one of the most iconic pursuit predators, hunting primarily throughout the day, sometimes with peaks at dawn and dusk; they tend to avoid larger predators like the primarily nocturnal lion.[66] Cheetahs in the Sahara and Maasai Mara in Kenya hunt after sunset to escape the high temperatures of the day.[123] Cheetahs use their vision to hunt instead of their sense of smell; they keep a lookout for prey from resting sites or low branches. This significantly sharpens the vision and enables the cheetah to swiftly locate prey against the horizon.[61][86] The cheetah is unable to roar due to the presence of a sharp-edged vocal fold within the larynx.[2][87]\\nSpeed and acceleration\\nThe cheetah is the world\'s fastest land animal.[88][89][90][91][92] Estimates of the maximum speed attained range from 80 to 128\xa0km/h (50 to 80\xa0mph).[60][63] A commonly quoted value is 112\xa0km/h (70\xa0mph), recorded in 1957, but this measurement is disputed.[93] The mouth can not be opened as widely as in other cats given the shorter length of muscles between the jaw and the skull.[60][65] A study suggested that the limited retraction of the cheetah\'s claws may result from the earlier truncation of the development of the middle phalanx bone in cheetahs.[77]\\nThe cheetah has a total of 30 teeth; the dental formula is 3.1.3.13.1.2.1.",\n      "metadata": {\n        "title": "Cheetah - Wikipedia",\n        "source": "https://en.wikipedia.org/wiki/Cheetah",\n        "score": 0.81312,\n        "images": null\n      }\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Check out this LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/e2e938e8-f847-4ea8-bc84-43d4eaf8e524/r",children:"here"}),"\nfor more on the internals."]}),"\n",(0,a.jsx)(n.h2,{id:"retrieval-post-processing",children:"Retrieval post-processing"}),"\n",(0,a.jsxs)(n.p,{children:["Another approach is to post-process our retrieved documents to compress\nthe content, so that the source content is already minimal enough that\nwe don\u2019t need the model to cite specific sources or spans. For example,\nwe could break up each document into a sentence or two, embed those and\nkeep only the most relevant ones. LangChain has some built-in components\nfor this. Here we\u2019ll use a\n",(0,a.jsx)(n.a,{href:"https://js.langchain.com/docs/modules/data_connection/document_transformers/recursive_text_splitter",children:(0,a.jsx)(n.code,{children:"RecursiveCharacterTextSplitter"})}),",\nwhich creates chunks of a specified size by splitting on separator\nsubstrings, and an\n",(0,a.jsx)(n.a,{href:"https://js.langchain.com/docs/modules/data_connection/retrievers/contextual_compression#embeddingsfilter",children:(0,a.jsx)(n.code,{children:"EmbeddingsFilter"})}),",\nwhich keeps only the texts with the most relevant embeddings."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'import { RecursiveCharacterTextSplitter } from "langchain/text_splitter";\nimport { EmbeddingsFilter } from "langchain/retrievers/document_compressors/embeddings_filter";\nimport { OpenAIEmbeddings } from "@langchain/openai";\nimport { DocumentInterface } from "@langchain/core/documents";\nimport { RunnableMap, RunnablePassthrough } from "@langchain/core/runnables";\n\nconst splitter = new RecursiveCharacterTextSplitter({\n  chunkSize: 400,\n  chunkOverlap: 0,\n  separators: ["\\n\\n", "\\n", ".", " "],\n  keepSeparator: false,\n});\n\nconst compressor = new EmbeddingsFilter({\n  embeddings: new OpenAIEmbeddings(),\n  k: 10,\n});\n\nconst splitAndFilter = async (input): Promise<Array<DocumentInterface>> => {\n  const { docs, question } = input;\n  const splitDocs = await splitter.splitDocuments(docs);\n  const statefulDocs = await compressor.compressDocuments(splitDocs, question);\n  return statefulDocs;\n};\n\nconst retrieveMap = RunnableMap.from({\n  question: new RunnablePassthrough(),\n  docs: retriever,\n});\n\nconst retriever = retrieveMap.pipe(splitAndFilter);\nconst docs = await retriever.invoke("How fast are cheetahs?");\nfor (const doc of docs) {\n  console.log(doc.pageContent, "\\n\\n");\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely reach velocities of 80\u2013100 km (50\u201362 miles) per hour while pursuing prey.\ncheetah,\n(Acinonyx jubatus),\n\n\nThe science of cheetah speed\nThe cheetah (Acinonyx jubatus) is the fastest land animal on Earth, capable of reaching speeds as high as 75 mph or 120 km/h. Cheetahs are predators that sneak up on their prey and sprint a short distance to chase and attack.\n Key Takeaways: How Fast Can a Cheetah Run?\nFastest Cheetah on Earth\n\n\nBuilt for speed, the cheetah can accelerate from zero to 45 in just 2.5 seconds and reach top speeds of 60 to 70 mph, making it the fastest land mammal! Fun Facts\nConservation Status\nCheetah News\nTaxonomic Information\nAnimal News\nNZCBI staff in Front Royal, Virginia, are mourning the loss of Walnut, a white-naped crane who became an internet sensation for choosing one of her keepers as her mate.\n\n\nThe speeds attained by the cheetah may be only slightly greater than those achieved by the pronghorn at 88.5\xa0km/h (55.0\xa0mph)[96] and the springbok at 88\xa0km/h (55\xa0mph),[97] but the cheetah additionally has an exceptional acceleration.[98]\n\n\nThe cheetah is the world's fastest land animal.[88][89][90][91][92] Estimates of the maximum speed attained range from 80 to 128\xa0km/h (50 to 80\xa0mph).[60][63] A commonly quoted value is 112\xa0km/h (70\xa0mph), recorded in 1957, but this measurement is disputed.[93] The mouth can not be opened as widely as in other cats given the shorter length of muscles between the jaw and the skull\n\n\nScientists calculate a cheetah's top speed is 75 mph, but the fastest recorded speed is somewhat slower. The top 10 fastest animals are:\n\n\nOne stride of a galloping cheetah measures 4 to 7\xa0m (13 to 23\xa0ft); the stride length and the number of jumps increases with speed.[60] During more than half the duration of the sprint, the cheetah has all four limbs in the air, increasing the stride length.[99] Running cheetahs can retain up to 90% of the heat generated during the chase\n\n\nThe pronghorn, an American animal resembling an antelope, is the fastest land animal in the Western Hemisphere. While a cheetah's top speed ranges from 65 to 75 mph (104 to 120 km/h), its average speed is only 40 mph (64 km/hr), punctuated by short bursts at its top speed. Basically, if a predator threatens to take a cheetah's kill or attack its young, a cheetah has to run.\n\n\nA cheetah eats a variety of small animals, including game birds, rabbits, small antelopes (including the springbok, impala, and gazelle), young warthogs, and larger antelopes (such as the kudu, hartebeest, oryx, and roan). Their faces are distinguished by prominent black lines that curve from the inner corner of each eye to the outer corners of the mouth, like a well-worn trail of inky tears.\n\n\nCheetahs are one of the most iconic pursuit predators, hunting primarily throughout the day, sometimes with peaks at dawn and dusk; they tend to avoid larger predators like the primarily nocturnal lion.[66] Cheetahs in the Sahara and Maasai Mara in Kenya hunt after sunset to escape the high temperatures of the day\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["See the LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/ae6b1f52-c1fe-49ec-843c-92edf2104652/r",children:"here"}),"\nto see the internals."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-typescript",children:'const chain4 = retrieveMap\n  .assign({ context: formatDocs })\n  .assign({ answer: answerChain })\n  .pick(["answer", "docs"]);\n\n// Note the documents have an article "summary" in the metadata that is now much longer than the\n// actual document page content. This summary isn\'t actually passed to the model.\nconst res = await chain4.invoke("How fast are cheetahs?");\n\nconsole.log(JSON.stringify(res, null, 2));\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'{\n  "answer": [\n    {\n      "answer": "\\nCheetahs are the fastest land animals. They can reach top speeds between 75-81 mph (120-130 km/h). \\n"\n    },\n    {\n      "citations": [\n        {\n          "citation": [\n            {\n              "source_id": "Article title: How Fast Can a Cheetah Run? - ThoughtCo"\n            },\n            {\n              "quote": "The science of cheetah speed\\nThe cheetah (Acinonyx jubatus) is the fastest land animal on Earth, capable of reaching speeds as high as 75 mph or 120 km/h."\n            }\n          ]\n        },\n        {\n          "citation": [\n            {\n              "source_id": "Article title: Cheetah - Wikipedia"\n            },\n            {\n              "quote": "Scientists calculate a cheetah\'s top speed is 75 mph, but the fastest recorded speed is somewhat slower."\n            }\n          ]\n        }\n      ]\n    }\n  ],\n  "docs": [\n    {\n      "pageContent": "The science of cheetah speed\\nThe cheetah (Acinonyx jubatus) is the fastest land animal on Earth, capable of reaching speeds as high as 75 mph or 120 km/h. Cheetahs are predators that sneak up on their prey and sprint a short distance to chase and attack.\\n Key Takeaways: How Fast Can a Cheetah Run?\\nFastest Cheetah on Earth\\nScientists calculate a cheetah\'s top speed is 75 mph, but the fastest recorded speed is somewhat slower. The top 10 fastest animals are:\\nThe pronghorn, an American animal resembling an antelope, is the fastest land animal in the Western Hemisphere. While a cheetah\'s top speed ranges from 65 to 75 mph (104 to 120 km/h), its average speed is only 40 mph (64 km/hr), punctuated by short bursts at its top speed. Basically, if a predator threatens to take a cheetah\'s kill or attack its young, a cheetah has to run.\\n",\n      "metadata": {\n        "title": "How Fast Can a Cheetah Run? - ThoughtCo",\n        "source": "https://www.thoughtco.com/how-fast-can-a-cheetah-run-4587031",\n        "score": 0.96949,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "The speeds attained by the cheetah may be only slightly greater than those achieved by the pronghorn at 88.5\xa0km/h (55.0\xa0mph)[96] and the springbok at 88\xa0km/h (55\xa0mph),[97] but the cheetah additionally has an exceptional acceleration.[98]\\nOne stride of a galloping cheetah measures 4 to 7\xa0m (13 to 23\xa0ft); the stride length and the number of jumps increases with speed.[60] During more than half the duration of the sprint, the cheetah has all four limbs in the air, increasing the stride length.[99] Running cheetahs can retain up to 90% of the heat generated during the chase. In December 2016 the results of an extensive survey detailing the distribution and demography of cheetahs throughout the range were published; the researchers recommended listing the cheetah as Endangered on the IUCN Red List.[25]\\nThe cheetah was reintroduced in Malawi in 2017.[160]\\nIn Asia\\nIn 2001, the Iranian government collaborated with the CCF, the IUCN, Panthera Corporation, UNDP and the Wildlife Conservation Society on the Conservation of Asiatic Cheetah Project (CACP) to protect the natural habitat of the Asiatic cheetah and its prey.[161][162] Individuals on the periphery of the prey herd are common targets; vigilant prey which would react quickly on seeing the cheetah are not preferred.[47][60][122]\\nCheetahs are one of the most iconic pursuit predators, hunting primarily throughout the day, sometimes with peaks at dawn and dusk; they tend to avoid larger predators like the primarily nocturnal lion.[66] Cheetahs in the Sahara and Maasai Mara in Kenya hunt after sunset to escape the high temperatures of the day.[123] Cheetahs use their vision to hunt instead of their sense of smell; they keep a lookout for prey from resting sites or low branches. This significantly sharpens the vision and enables the cheetah to swiftly locate prey against the horizon.[61][86] The cheetah is unable to roar due to the presence of a sharp-edged vocal fold within the larynx.[2][87]\\nSpeed and acceleration\\nThe cheetah is the world\'s fastest land animal.[88][89][90][91][92] Estimates of the maximum speed attained range from 80 to 128\xa0km/h (50 to 80\xa0mph).[60][63] A commonly quoted value is 112\xa0km/h (70\xa0mph), recorded in 1957, but this measurement is disputed.[93] The mouth can not be opened as widely as in other cats given the shorter length of muscles between the jaw and the skull.[60][65] A study suggested that the limited retraction of the cheetah\'s claws may result from the earlier truncation of the development of the middle phalanx bone in cheetahs.[77]\\nThe cheetah has a total of 30 teeth; the dental formula is 3.1.3.13.1.2.1.",\n      "metadata": {\n        "title": "Cheetah - Wikipedia",\n        "source": "https://en.wikipedia.org/wiki/Cheetah",\n        "score": 0.96423,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "One of two videos from National Geographic\'s award-winning multimedia coverage of cheetahs in the magazine\'s November 2012 iPad edition. See the other: http:...",\n      "metadata": {\n        "title": "The Science of a Cheetah\'s Speed | National Geographic",\n        "source": "https://www.youtube.com/watch?v=icFMTB0Pi0g",\n        "score": 0.96071,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "Contact Us \u2212 +\\nAddress\\nSmithsonian\'s National Zoo & Conservation\xa0Biology\xa0Institute\xa0\xa03001 Connecticut Ave., NW\xa0\xa0Washington, DC 20008\\nAbout the Zoo\\n\u2212\\n+\\nCareers\\n\u2212\\n+\\nNews & Media\\n\u2212\\n+\\nFooter Donate\\n\u2212\\n+\\nShop\\n\u2212\\n+\\nFollow us on social media\\nSign Up for Emails\\nFooter - SI logo, privacy, terms Conservation Efforts\\nHistorically, cheetahs ranged widely throughout Africa and Asia, from the Cape of Good Hope to the Mediterranean, throughout the Arabian Peninsula and the Middle East, from Israel, India and Pakistan north to the northern shores of the Caspian and Aral Seas, and west through Uzbekistan, Turkmenistan, Afghanistan, and Pakistan into central India. Header Links\\nToday\'s hours: 8 a.m. to 4 p.m. (last entry 3 p.m.)\\nMega menu\\nAnimals Global Nav Links\\nElephant Cam\\nSee the Smithsonian\'s National Zoo\'s Asian elephants \u2014 Spike, Bozie, Kamala, Swarna and Maharani \u2014 both inside the Elephant Community Center and outside in their yards.\\n Conservation Global Nav Links\\nAbout the Smithsonian Conservation Biology Institute\\nCheetah\\nAcinonyx jubatus\\nBuilt for speed, the cheetah can accelerate from zero to 45 in just 2.5 seconds and reach top speeds of 60 to 70 mph, making it the fastest land mammal! Fun Facts\\nConservation Status\\nCheetah News\\nTaxonomic Information\\nAnimal News\\nNZCBI staff in Front Royal, Virginia, are mourning the loss of Walnut, a white-naped crane who became an internet sensation for choosing one of her keepers as her mate.\\n",\n      "metadata": {\n        "title": "Cheetah | Smithsonian\'s National Zoo and Conservation Biology Institute",\n        "source": "https://nationalzoo.si.edu/animals/cheetah",\n        "score": 0.91577,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "The maximum speed cheetahs have been measured at is 114 km (71 miles) per hour, and they routinely reach velocities of 80\u2013100 km (50\u201362 miles) per hour while pursuing prey.\\ncheetah,\\n(Acinonyx jubatus),\\none of the world\u2019s most-recognizable cats, known especially for its speed. Their fur is dark and includes a thick yellowish gray mane along the back, a trait that presumably offers better camouflage and increased protection from high temperatures during the day and low temperatures at night during the first few months of life. Cheetahs eat a variety of small animals, including game birds, rabbits, small antelopes (including the springbok, impala, and gazelle), young warthogs, and larger antelopes (such as the kudu, hartebeest, oryx, and roan).\\n A cheetah eats a variety of small animals, including game birds, rabbits, small antelopes (including the springbok, impala, and gazelle), young warthogs, and larger antelopes (such as the kudu, hartebeest, oryx, and roan). Their faces are distinguished by prominent black lines that curve from the inner corner of each eye to the outer corners of the mouth, like a well-worn trail of inky tears.",\n      "metadata": {\n        "title": "Cheetah | Description, Speed, Habitat, Diet, Cubs, & Facts",\n        "source": "https://www.britannica.com/animal/cheetah-mammal",\n        "score": 0.91163,\n        "images": null\n      }\n    },\n    {\n      "pageContent": "If a lion comes along, the cheetah will abandon its catch -- it can\'t fight off a lion, and chances are, the cheetah will lose its life along with its prey if it doesn\'t get out of there fast enough.\\n Advertisement\\nLots More Information\\nMore Great Links\\nSources\\nPlease copy/paste the following text to properly cite this HowStuffWorks.com article:\\nAdvertisement\\nAdvertisement\\nAdvertisement\\nAdvertisement\\nAdvertisement If confronted, a roughly 125-pound cheetah will always run rather than fight -- it\'s too weak, light and thin to have any chance against something like a lion, which can be twice as long as a cheetah and weigh more than 400 pounds (181.4 kg) Cheetah moms spend a lot of time teaching their cubs to chase, sometimes dragging live animals back to the den so the cubs can practice the chase-and-catch process.\\n It\'s more like a bound at that speed, completing up to three strides per second, with only one foot on the ground at any time and several stages when feet don\'t touch the ground at all.",\n      "metadata": {\n        "title": "What makes a cheetah run so fast? | HowStuffWorks",\n        "source": "https://animals.howstuffworks.com/mammals/cheetah-speed.htm",\n        "score": 0.89019,\n        "images": null\n      }\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Check out the LangSmith trace\n",(0,a.jsx)(n.a,{href:"https://smith.langchain.com/public/b767cca0-6061-4208-99f2-7f522b94a587/r",children:"here"}),"\nto see the internals."]}),"\n",(0,a.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,a.jsx)(n.p,{children:"You\u2019ve now learned a few ways to return citations from your QA chains."}),"\n",(0,a.jsxs)(n.p,{children:["Next, check out some of the other guides in this section, such as ",(0,a.jsx)(n.a,{href:"../../docs/how_to/qa_chat_history_how_to",children:"how\nto add chat history"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);